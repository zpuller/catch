import * as CANNON from 'cannon-es'

const createBody = (conf) => {
    const { s, p, q } = conf
    return new CANNON.Body({
        type: CANNON.Body.STATIC,
        shape: new CANNON.Box(new CANNON.Vec3(s.w, s.h, s.d)),
        position: new CANNON.Vec3(p.x, p.y, p.z),
        quaternion: new CANNON.Quaternion(q?.x || 0, q?.y || 0, q?.z || 0, q?.w || 1)
    })
}

const createBodies = (conf) => {
    return conf.map(createBody)
}

export default class StaticEntities {
    constructor(handlers) {
        this.bodies = createBodies([
            // Floor
            { s: { 'w': 8, 'h': 1, 'd': 8 }, p: { 'x': 0, 'y': -1, 'z': 0 } },
            // Couch
            { s: { 'w': 1.5, 'h': 0.14, 'd': 0.56 }, p: { 'x': 2.81, 'y': 0.14, 'z': -2.34 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.1, 'h': 0.34, 'd': 0.53 }, p: { 'x': 1.25, 'y': 0.34, 'z': -2.45 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.1, 'h': 0.34, 'd': 0.53 }, p: { 'x': 4.38, 'y': 0.34, 'z': -2.45 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.755, 'h': 0.115, 'd': 0.545 }, p: { 'x': 2.06, 'y': 0.37, 'z': -2.27 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.755, 'h': 0.115, 'd': 0.545 }, p: { 'x': 3.52, 'y': 0.37, 'z': -2.27 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.795, 'h': 0.285, 'd': 0.145 }, p: { 'x': 2.07, 'y': 0.68, 'z': -2.77 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.795, 'h': 0.285, 'd': 0.145 }, p: { 'x': 3.52, 'y': 0.68, 'z': -2.77 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.305, 'h': 0.335, 'd': 0.15 }, p: { 'x': 1.86, 'y': 0.81, 'z': -2.45 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.305, 'h': 0.335, 'd': 0.15 }, p: { 'x': 4.07, 'y': 0.82, 'z': -2.52 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            { s: { 'w': 0.305, 'h': 0.335, 'd': 0.15 }, p: { 'x': 3.87, 'y': 0.8, 'z': -2.21 }, q: { 'x': 0.0, 'y': 0.0, 'z': -0.0, 'w': 1.0 } },
            // TV Stand
            { s: { 'w': 0.5, 'h': 0.425, 'd': 0.35 }, p: { 'x': 2.63, 'y': 0.35, 'z': 1.39 }, q: { 'x': -0.15304601192474365, 'y': 0.6903454661369324, 'z': -0.6903455853462219, 'w': -0.15304598212242126 } },
            // Fan
            { s: { 'w': 0.8, 'h': 0.25, 'd': 0.8 }, p: { 'x': 3, 'y': 3.7, 'z': -2 } },
            // Plant
            { s: { 'w': 0.3, 'h': 0.25, 'd': 0.3 }, p: { 'x': -4.25, 'y': 0.25, 'z': -4.25 } },
        ])

        const tv = createBody({ s: { 'w': 0.5, 'h': 0.35, 'd': 0.2 }, p: { 'x': 2.62, 'y': 1.06, 'z': 1.37 }, q: { 'x': 0, 'y': -0.976296, 'z': 0, 'w': 0.2164396 } })
        tv.addEventListener('collide', handlers.tv)

        this.bodies.push(tv)
    }
}